
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="非对称加密，数字证书与 CA，ssl 原理概述与应用">
      
      
      
        <meta name="author" content="mapan">
      
      
        <link rel="canonical" href="https://mapan1984.github.io/network-security/3-%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/1-OpenSSL%20%E6%89%8B%E5%86%8C/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.0">
    
    
      
        <title>3.1 OpenSSL 手册 - 网络安全</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openssl" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="网络安全" class="md-header__button md-logo" aria-label="网络安全" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            网络安全
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3.1 OpenSSL 手册
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/mapan1984/network-security/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="网络安全" class="md-nav__button md-logo" aria-label="网络安全" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    网络安全
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/mapan1984/network-security/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        0. 网络安全
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="../../1-SSL%20%E5%8E%9F%E7%90%86%E6%A6%82%E8%BF%B0/" class="md-nav__link"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            1. ssl 原理概述
          </a>
        </label>
      
      <nav class="md-nav" aria-label="1. ssl 原理概述" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="../../1-SSL%20%E5%8E%9F%E7%90%86%E6%A6%82%E8%BF%B0/" class="md-nav__link"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            1. ssl 原理概述
          </a>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-SSL%20%E5%8E%9F%E7%90%86%E6%A6%82%E8%BF%B0/1-%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/" class="md-nav__link">
        1.1 非对称加密
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-SSL%20%E5%8E%9F%E7%90%86%E6%A6%82%E8%BF%B0/2-%E8%AF%81%E4%B9%A6%E4%B8%8E%20CA/" class="md-nav__link">
        1.2 证书与 CA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-SSL%20%E5%8E%9F%E7%90%86%E6%A6%82%E8%BF%B0/3-SSL%20%E5%8D%8F%E8%AE%AE/" class="md-nav__link">
        1.3 SSL 协议
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="../../2-%E5%BA%94%E7%94%A8/" class="md-nav__link"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            2. 应用
          </a>
        </label>
      
      <nav class="md-nav" aria-label="2. 应用" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="../../2-%E5%BA%94%E7%94%A8/" class="md-nav__link"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            2. 应用
          </a>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-%E5%BA%94%E7%94%A8/1-SSH%20%E7%99%BB%E5%BD%95/" class="md-nav__link">
        2.1 SSH 登录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-%E5%BA%94%E7%94%A8/2-https/" class="md-nav__link">
        2.2 https
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="../" class="md-nav__link"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            3. 实践手册
          </a>
        </label>
      
      <nav class="md-nav" aria-label="3. 实践手册" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="../" class="md-nav__link"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            3. 实践手册
          </a>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="./" class="md-nav__link md-nav__link--active"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            3.1 OpenSSL 手册
          </a>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        3.1 OpenSSL 手册
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    命令
  </a>
  
    <nav class="md-nav" aria-label="命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rsa" class="md-nav__link">
    生成 rsa 密钥对
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csr-certificate-sign-request" class="md-nav__link">
    生成 csr (certificate sign request) 文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    生成签名证书
  </a>
  
    <nav class="md-nav" aria-label="生成签名证书">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    自签名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ca" class="md-nav__link">
    ca 签名
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    密码套件
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    问题
  </a>
  
    <nav class="md-nav" aria-label="问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ee-key-too-small" class="md-nav__link">
    ee key too small 问题
  </a>
  
    <nav class="md-nav" aria-label="ee key too small 问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    参考
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-routinesssl3_get_recordwrong-version-number" class="md-nav__link">
    SSL routines:ssl3_get_record:wrong version number
  </a>
  
    <nav class="md-nav" aria-label="SSL routines:ssl3_get_record:wrong version number">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    参考
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2-keytool%20%E6%89%8B%E5%86%8C/" class="md-nav__link">
        3.2 keytool 手册
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="../../4-%E5%85%B6%E4%BB%96/" class="md-nav__link"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            4. 其他
          </a>
        </label>
      
      <nav class="md-nav" aria-label="4. 其他" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          
            <a href="../../4-%E5%85%B6%E4%BB%96/" class="md-nav__link"
              style="margin: initial; padding: initial; pointer-events: initial">
          
            4. 其他
          </a>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4-%E5%85%B6%E4%BB%96/1-%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/" class="md-nav__link">
        4.1 名称解释
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4-%E5%85%B6%E4%BB%96/2-RSA%20%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/" class="md-nav__link">
        4.2 RSA 加密算法
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    命令
  </a>
  
    <nav class="md-nav" aria-label="命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rsa" class="md-nav__link">
    生成 rsa 密钥对
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csr-certificate-sign-request" class="md-nav__link">
    生成 csr (certificate sign request) 文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    生成签名证书
  </a>
  
    <nav class="md-nav" aria-label="生成签名证书">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    自签名
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ca" class="md-nav__link">
    ca 签名
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    密码套件
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    问题
  </a>
  
    <nav class="md-nav" aria-label="问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ee-key-too-small" class="md-nav__link">
    ee key too small 问题
  </a>
  
    <nav class="md-nav" aria-label="ee key too small 问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    参考
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-routinesssl3_get_recordwrong-version-number" class="md-nav__link">
    SSL routines:ssl3_get_record:wrong version number
  </a>
  
    <nav class="md-nav" aria-label="SSL routines:ssl3_get_record:wrong version number">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    参考
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/mapan1984/network-security/edit/master/docs/3-实践手册/1-OpenSSL 手册.md" title="编辑此页" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="openssl">openssl</h1>
<p>OpenSSL 实用程序可在命令行使用，程序也可以调用 OpenSSL 库中的函数。</p>
<h2 id="_1">命令</h2>
<p>查看版本：</p>
<div class="highlight"><pre><span></span><code>$ openssl version
OpenSSL 1.0.0-fips 29 Mar 2010
</code></pre></div>
<p>常用：</p>
<ul>
<li>genrsa: 生成 rsa 密钥对</li>
<li>req</li>
<li>x509</li>
<li>rsa</li>
<li>ca</li>
</ul>
<h3 id="rsa">生成 rsa 密钥对</h3>
<div class="highlight"><pre><span></span><code>openssl genrsa [args] [numbits]
</code></pre></div>
<ul>
<li>args1 对生成的私钥文件是否要使用加密算法进行对称加密：<ul>
<li><code>-des</code></li>
<li><code>-des3</code></li>
<li><code>-aes128</code></li>
<li><code>-aes192</code></li>
<li><code>-aes256</code></li>
</ul>
</li>
<li>args2 对称加密密码(可以省去 console 交互提示输入密码的环节)<ul>
<li><code>-passout pass:password</code></li>
</ul>
</li>
<li>args3 输出文件<ul>
<li><code>-out file</code></li>
</ul>
</li>
<li>numbits 密钥长度</li>
</ul>
<p>生成 2048 bit 的 rsa 私钥：</p>
<div class="highlight"><pre><span></span><code>openssl genrsa -out server.key 2048
</code></pre></div>
<p>在生成 rsa 私钥时使用 aes128 对称密钥算法加密生成的私钥（会提示输入密码，之后使用的时候必须输入该密码）</p>
<div class="highlight"><pre><span></span><code>openssl genrsa -aes128 -out server.key 2048
</code></pre></div>
<p>可以直接指定密码</p>
<div class="highlight"><pre><span></span><code>openssl genrsa -aes128 -passout pass:password -out server.key 2048
</code></pre></div>
<p>提取私钥对应的 ras 公钥：</p>
<div class="highlight"><pre><span></span><code>openssl rsa -in server.key -pubout -out server.pem
</code></pre></div>
<blockquote>
<p>公钥/私钥以 pem 格式存储，该格式仅包含文本</p>
</blockquote>
<h3 id="csr-certificate-sign-request">生成 csr (certificate sign request) 文件</h3>
<div class="highlight"><pre><span></span><code>openssl req [args] outfile
</code></pre></div>
<p>根据私钥生成 csr 文件：</p>
<div class="highlight"><pre><span></span><code>openssl req -new -key ca.key -out ca.csr
openssl req -new -key -nodes server.key -subj &quot;/CN=localhost&quot; -out server.csr
openssl req -new -key -nodes -x509 ca-key.pem -days 10000 -out ca.pem -subj &quot;/CN=kube-ca&quot;
</code></pre></div>
<ul>
<li><code>-new</code>: new request</li>
<li><code>-key file</code>: use the private key contained in file</li>
<li><code>-nodes</code>: don't encrypt the output key</li>
<li><code>-subj arg</code>: set or modify request subject</li>
<li><code>-out arg</code>: output file</li>
<li><code>-x509</code>: output a x509 structure instead of a cert. req.</li>
<li><code>-days</code>: number of days a certificate generated by -x509 is valid for.</li>
</ul>
<h3 id="_2">生成签名证书</h3>
<p>用私钥对 csr 文件签名：</p>
<h4 id="_3">自签名</h4>
<div class="highlight"><pre><span></span><code>openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt

openssl x509 -req -sha256 -days 365 -in server.csr -signkey server.key -out server.crt
</code></pre></div>
<h4 id="ca">ca 签名</h4>
<div class="highlight"><pre><span></span><code>openssl x509 -req -in apiserver.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out apiserver.pem -days 365 -extensions v3_req
</code></pre></div>
<ul>
<li><code>-req</code>: input is a certificate request, sign and output.</li>
<li><code>-in arg</code>: input file - default stdin</li>
<li><code>-out arg</code>: output file - default stdout</li>
<li>
<p><code>-days arg</code>: How long till expiry of a signed certificate - def 30 days</p>
</li>
<li>
<p><code>-signkey arg</code>: self sign cert with arg</p>
</li>
<li>
<p><code>-CA arg</code>: set the CA certificate, must be PEM format.</p>
</li>
<li><code>-CAkey arg</code>: set the CA key, must be PEM format missing, it is assumed to be in the CA file.</li>
<li><code>-CAcreateserial</code>: create serial number file if it does not exist</li>
</ul>
<h2 id="_4">密码套件</h2>
<p><a href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%A5%97%E4%BB%B6">密码套件</a></p>
<ul>
<li>非对称加密算法</li>
<li>对称加密算法</li>
<li>数据摘要算法</li>
</ul>
<p>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</p>
<p>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</p>
<ul>
<li>密钥交换算法（RSA、DH、ECDH、PSK）</li>
<li>身份验证算法（RSA、DSA）</li>
<li>批量加密算法（AES、Camellia、ARIA）</li>
<li>消息身份验证码算法（SHA-256）</li>
</ul>
<h2 id="_5">问题</h2>
<h3 id="ee-key-too-small">ee key too small 问题</h3>
<p>原因：OpenSSL 1.1.1k 之后，1024 bit 长度不再被是为安全</p>
<p>3 种解决方法：</p>
<ol>
<li>降低 openssl 版本到 1.1.1k 之下</li>
<li>修改 openssl 配置文件 <code>openssl.cnf</code>，将 <code>CipherString = DEFAULT@SECLEVEL=2</code> 改为 <code>CipherString = DEFAULT@SECLEVEL=1</code>(<code>sed -i 's/DEFAULT@SECLEVEL=2/DEFAULT@SECLEVEL=1/' /etc/ssl/openssl.cnf</code>)</li>
<li>重新生成证书</li>
</ol>
<h4 id="_6">参考</h4>
<ul>
<li>https://discuss.aerospike.com/t/ssl-key-too-small-error-on-startup/8075
    &gt; This is an SSL error message. The reason the error is shown is because as of openSSL 1.1.0k, 1024 bit certificates were no longer considered secure and will therefore be rejected.</li>
<li>https://github.com/jfromaniello/selfsigned/issues/33
    &gt; Only way around it is to modify: /etc/ssl/openssl.cnf and change:
    &gt;
    &gt; CipherString = DEFAULT@SECLEVEL=2
    &gt; to
    &gt; CipherString = DEFAULT@SECLEVEL=1
    &gt;
    &gt; I believe the issue is the referenced issue above and generating the client certificates as 1024 bit. SECLEVEL=2 requires minimum of 2048 bit.</li>
<li>https://github.com/debauchee/barrier/issues/126
    &gt; It is just a matter of editing file /etc/ssl/openssl.cnf changing last line
    &gt; from:
    &gt; CipherString = DEFAULT@SECLEVEL=2
    &gt; to
    &gt; CipherString = DEFAULT@SECLEVEL=1</li>
<li>https://unix.stackexchange.com/questions/537279/overriding-openssl-cipherstring-at-a-more-granular-level-in-debian-10</li>
<li>https://www.openssl.org/news/cl110.txt</li>
</ul>
<h3 id="ssl-routinesssl3_get_recordwrong-version-number">SSL routines:ssl3_get_record:wrong version number</h3>
<p>原因：1.1.0 默认禁止使用 DSS cipher</p>
<h4 id="_7">参考</h4>
<ul>
<li>https://github.com/openssl/openssl/issues/6289</li>
<li>https://github.com/Shopify/sarama/issues/643</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../" class="md-footer__link md-footer__link--prev" aria-label="上一页: 3. 实践手册" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              3. 实践手册
            </div>
          </div>
        </a>
      
      
        
        <a href="../2-keytool%20%E6%89%8B%E5%86%8C/" class="md-footer__link md-footer__link--next" aria-label="下一页: 3.2 keytool 手册" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              3.2 keytool 手册
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>